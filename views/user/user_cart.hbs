<style>
  @media (min-width: 1025px) {
    .h-custom {
      height: 100vh !important;
    }
  }

  .card-registration .select-input.form-control[readonly]:not([disabled]) {
    font-size: 1rem;
    line-height: 2.15;
    padding-left: .75em;
    padding-right: .75em;
  }

  .card-registration .select-arrow {
    top: 13px;
  }

  .bg-grey {
    background-color: #547a9d;
  }

  @media (min-width: 992px) {
    .card-registration-2 .bg-grey {
      border-top-right-radius: 16px;
      border-bottom-right-radius: 16px;
    }
  }

  @media (max-width: 991px) {
    .card-registration-2 .bg-grey {
      border-bottom-left-radius: 16px;
      border-bottom-right-radius: 16px;
    }
  }



  @import url(http://fonts.googleapis.com/css?family=Calibri:400,300,700);

  body {
    background-color: rgb(255, 255, 255);
    font-family: 'Calibri', sans-serif !important;
  }

  .mt-100 {
    margin-top: 100px;

  }


  .card {
    margin-bottom: 30px;
    border: 0;
    -webkit-transition: all .3s ease;
    transition: all .3s ease;
    letter-spacing: .5px;
    border-radius: 8px;
    -webkit-box-shadow: 1px 5px 24px 0 rgba(68, 102, 242, .05);
    box-shadow: 1px 5px 24px 0 rgba(68, 102, 242, .05);
  }

  .card .card-header {
    background-color: #fff;
    border-bottom: none;
    padding: 24px;
    border-bottom: 1px solid #f6f7fb;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
  }

  .card-header:first-child {
    border-radius: calc(.25rem - 1px) calc(.25rem - 1px) 0 0;
  }



  .card .card-body {
    padding: 30px;
    background-color: transparent;
  }

  .btn-primary,
  .btn-primary.disabled,
  .btn-primary:disabled {
    background-color: #4466f2 !important;
    border-color: #4466f2 !important;
  }
</style>

{{#if cartempty}}
<div class="container-fluid  mt-5">
  <div class="row">

    <div class="col-md-12">

      <div class="">

        <div class=" cart">
          <div class="col-sm-12 empty-cart-cls text-center">
            <img src="https://i.imgur.com/dCdflKN.png" width="130" height="130" class="img-fluid mb-4 mr-3">
            <h3><strong>Your Cart is Empty</strong></h3>
            <h5>Add something :)</h5>
            <a href="/shop" class="btn btn-outline-info  cart-btn-transform m-3" data-abc="true">Shop Here</a>


          </div>
        </div>
      </div>


    </div>

  </div>

</div>


{{else}}

<section class="h-100" style="background-color: #dbdbdb;">
  <div class="container py-5 h-100" >
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-12">
        <div class="card card-registration card-registration-2" style="border-radius: 15px;" id="mydiv11">
          <div class="card-body p-0" >
            <div class="row g-0" >
              <div class="col-lg-8"  >
                <div class="p-5">
                  <div class="d-flex justify-content-between align-items-center mb-5">
                    <h1 class="fw-bold mb-0 text-black">Shopping Cart</h1>
                    <h6 class="mb-0 text-muted">{{cartcount}} items</h6>
                  </div>
                  {{#each productdetails}}
                  {{#each this.cartdata}}
                  <hr class="my-4">

                  <div class="row mb-4 d-flex justify-content-center align-items-center">
                    <div class="col-md-2 col-lg-2 col-xl-2">
                      <img src="/productimages/{{this.productId.image.[0]}}" src="#" class="img-fluid rounded-3"
                        alt="Cotton T-shirt">
                    </div>
                    <div class="col-md-3 col-lg-3 col-xl-3">
                      <h6 class="text-muted">Shirt</h6>
                      <h6 class="text-black mb-0">{{this.productId.productname}}</h6>
                    </div>


                    <div class="col bold text-nowrap">


                      <a class="btn" {{#if (gt this.quantity 1)}} onclick="decrementqty('{{this.productId._id}}')"
                        {{/if}}>-</a>




                      <span id="{{this.productId._id}}"
                        style="padding: 5px; border: 2px solid rgb(209, 209, 209) ;border-style: solid; border-radius: 3px;">{{this.quantity}}</span>
                      <a class="btn" onclick="incrementqty('{{this.productId._id}}')">+</a>

                    </div>
                    <div class="col">
                      <div class="row text-muted"></div>
                      <div class="row font-weight-light " style="color: rgba(178, 3, 3, 0.781);">
                        <span><s>&#8377;{{subTotal this.quantity this.productId.price}}</s></span>
                      </div>
                    </div>
                    <div class="col">

                      <div class="row font-weight-bold px-1">&#8377;{{subTotal this.quantity
                        this.productId.discountprice}}</div>
                    </div>
                    <div class="col">
                      <div class="row text-muted"></div>
                      <div class="row text-success">&#8377;{{this.productId.percentage}}%off</div>
                    </div>

                    <div class="col">
                      <a  onclick="remove('{{this.productId._id}}')" style="cursor: pointer;">
                        <div class="col"><span class="close">&#10005;</span></div>
                      </a>
                    </div>

                  </div>


                  {{/each}}
                  {{/each}}
                  <div class="pt-5">
                    <h6 class="mb-0"><a href="/shop" class="text-body"><i
                          class="fas fa-long-arrow-alt-left me-2"></i>Back to shop</a></h6>
                  </div>
                </div>
              </div>
              <div class="col-lg-4 bg-grey">
                <div class="p-5">
                  <h3 class="fw-bold mb-5 mt-2 pt-1 text-light">Summary</h3>
                  <hr class="my-4">

                  <div class="d-flex justify-content-between mb-4">
                    <h5 class="text-uppercase text-light">Price ({{cartcount}}items)</h5>
                    <h5 class="text-light">&#8377;{{totalamount.totalmrp}}</h5>
                  </div>
                  <div class="d-flex justify-content-between mb-4">
                    <h5 class="text-uppercase text-light">Discount</h5>
                    <h5 class="text-light">&#8377;{{totalamount.dicount}}</h5>
                  </div>
                  <hr class="my-4">

                  <div class="d-flex justify-content-between mb-5">
                    <h5 class="text-uppercase text-light">Total price</h5>
                    <h5 class="text-light">{{totalamount.total}}</h5>
                  </div>

                  <a class="btn btn-outline-warning btn-block btn-lg" data-mdb-ripple-color="dark" type="submit"
                    href="/checkout">Proceed</a>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


{{/if}}







<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>




  function decrementqty(id) {

    const res = axios.post(`/decrementqty/${id}`, {}).then((e) => {
      console.log(e)
      e.data.response
      document.getElementById(id).innerHTML = e.data.quantity

      $("#mydiv11").load(location.href + " #mydiv11>*", "")
    })

  }

  function incrementqty(id) {

    const res = axios.post(`/incrementqty/${id}`, {}).then((e) => {
      console.log(e, 'eeeinc eeeenc incqty')
      e.data.response


      document.getElementById(id).innerHTML = e.data.quantity
     $("#mydiv11").load(location.href + " #mydiv11>*", "")


    })
  }


   

    function remove(id) {

    swal({
      title: "Are you sure?",
      
      icon: "warning",
      buttons: true,
      dangerMode: true,
    })
      .then(async(willDelete) => {
        if (willDelete) {
          console.log(id,'ififiififiididiidididididiidiidid')

          await axios({
            method: 'get',
            url: '/deletecart/' + id

          }).then((response) => {
            console.log(response, 'this is response');

            location.reload()
          }).catch((error) => {
            console.log(error, "catch error at delivered axios.")
          })

          swal("Item removed :( !", {
            icon: "success",
          });
        } else {
          swal("Thank you!");
        }
      })







  }


</script>